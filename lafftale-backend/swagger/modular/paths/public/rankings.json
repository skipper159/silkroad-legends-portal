{
  "/api/rankings/{type}": {
    "get": {
      "tags": ["Rankings"],
      "summary": "Get player rankings",
      "description": "Retrieve player rankings by type",
      "parameters": [
        {
          "name": "type",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "enum": [
              "top-player",
              "top-guild",
              "unique",
              "unique-monthly",
              "honor",
              "job",
              "job-all",
              "job-hunter",
              "job-thief",
              "job-trader",
              "job-statistics",
              "job-leaderboard-comparison",
              "job-progression",
              "fortress-player",
              "fortress-guild",
              "pvp-kd",
              "job-kd",
              "item-plus",
              "item-drop",
              "guild"
            ]
          },
          "description": "Ranking type"
        },
        {
          "name": "limit",
          "in": "query",
          "schema": { "type": "integer", "default": 50, "maximum": 100 },
          "description": "Number of entries to return"
        },
        {
          "name": "offset",
          "in": "query",
          "schema": { "type": "integer", "default": 0 },
          "description": "Number of entries to skip"
        },
        {
          "name": "page",
          "in": "query",
          "schema": { "type": "integer", "default": 1 },
          "description": "Page number for pagination"
        },
        {
          "name": "jobType",
          "in": "query",
          "schema": { "type": "integer", "enum": [1, 2, 3] },
          "description": "Job type filter for job-progression endpoint (1=Trader, 2=Thief, 3=Hunter)"
        }
      ],
      "responses": {
        "200": {
          "description": "Rankings retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "allOf": [
                  { "$ref": "#/components/schemas/SuccessResponse" },
                  {
                    "type": "object",
                    "properties": {
                      "data": {
                        "oneOf": [
                          {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/RankingPlayer"
                            },
                            "description": "Standard player ranking data"
                          },
                          {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/JobRanking"
                            },
                            "description": "Job-specific ranking data"
                          },
                          {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/JobStatistics"
                            },
                            "description": "Job statistics data"
                          },
                          {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/JobLeaderboardEntry"
                            },
                            "description": "Job leaderboard comparison data"
                          },
                          {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/JobProgressionData"
                            },
                            "description": "Job progression analytics data"
                          },
                          {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/HonorRanking"
                            },
                            "description": "Honor system ranking data"
                          },
                          {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/FortressRanking"
                            },
                            "description": "Fortress system ranking data"
                          },
                          {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/ItemEnhancementRanking"
                            },
                            "description": "Item enhancement ranking data"
                          },
                          {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/ItemDropRanking"
                            },
                            "description": "Item drop ranking data"
                          }
                        ]
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "400": { "$ref": "#/components/responses/BadRequest" },
        "500": { "$ref": "#/components/responses/InternalServerError" }
      }
    }
  },
  "/api/rankings-extended/{type}": {
    "get": {
      "tags": ["Rankings"],
      "summary": "Get extended player rankings",
      "description": "Retrieve extended player rankings with more detailed information",
      "parameters": [
        {
          "name": "type",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "enum": ["level", "guild", "job", "pk", "honor", "wealth"]
          },
          "description": "Ranking type"
        },
        {
          "name": "limit",
          "in": "query",
          "schema": { "type": "integer", "default": 50, "maximum": 100 }
        },
        {
          "name": "offset",
          "in": "query",
          "schema": { "type": "integer", "default": 0 }
        },
        {
          "name": "includeStats",
          "in": "query",
          "schema": { "type": "boolean", "default": false },
          "description": "Include detailed character statistics"
        }
      ],
      "responses": {
        "200": {
          "description": "Extended rankings retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "allOf": [
                  { "$ref": "#/components/schemas/SuccessResponse" },
                  {
                    "type": "object",
                    "properties": {
                      "data": {
                        "type": "object",
                        "properties": {
                          "rankings": {
                            "type": "array",
                            "items": {
                              "allOf": [
                                { "$ref": "#/components/schemas/RankingEntry" },
                                {
                                  "type": "object",
                                  "properties": {
                                    "characterDetails": {
                                      "$ref": "#/components/schemas/Character"
                                    },
                                    "guildName": { "type": "string" },
                                    "lastSeen": {
                                      "type": "string",
                                      "format": "date-time"
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "totalEntries": { "type": "integer" },
                          "lastUpdated": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "400": { "$ref": "#/components/responses/BadRequest" }
      }
    }
  },
  "/api/rankings/fortress-current": {
    "get": {
      "tags": ["Rankings"],
      "summary": "Get current fortress owner",
      "description": "Returns a small summary object with the current fortress owner guild and time held. This endpoint may use fortress guild rankings as approximation.",
      "responses": {
        "200": {
          "description": "Fortress owner retrieved",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean" },
                  "data": {
                    "type": "object",
                    "properties": {
                      "guild": { "type": "string" },
                      "fortress": { "type": "string" },
                      "timeHeld": { "type": "string" }
                    }
                  },
                  "timestamp": { "type": "string", "format": "date-time" }
                }
              }
            }
          }
        },
        "500": { "$ref": "#/components/responses/InternalServerError" }
      }
    }
  },
  "/api/rankings/job-statistics": {
    "get": {
      "tags": ["Rankings"],
      "summary": "Get comprehensive job statistics",
      "description": "Comprehensive job statistics across all job types with analytics",
      "parameters": [
        {
          "name": "includeInactive",
          "in": "query",
          "schema": { "type": "boolean", "default": false },
          "description": "Include inactive jobs in statistics"
        }
      ],
      "responses": {
        "200": {
          "description": "Job statistics retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean" },
                  "data": {
                    "type": "object",
                    "properties": {
                      "totalJobs": { "type": "integer" },
                      "jobDistribution": {
                        "type": "object",
                        "properties": {
                          "hunter": { "type": "integer" },
                          "thief": { "type": "integer" },
                          "trader": { "type": "integer" }
                        }
                      },
                      "averageLevel": { "type": "number" },
                      "kdRatios": {
                        "type": "object",
                        "properties": {
                          "overall": { "type": "number" },
                          "hunter": { "type": "number" },
                          "thief": { "type": "number" },
                          "trader": { "type": "number" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "500": { "$ref": "#/components/responses/InternalServerError" }
      }
    }
  },
  "/api/rankings/job-leaderboard-comparison": {
    "get": {
      "tags": ["Rankings"],
      "summary": "Get job leaderboard comparison",
      "description": "Compares top players across different job types with unified ranking system",
      "parameters": [
        {
          "name": "limit",
          "in": "query",
          "schema": {
            "type": "integer",
            "default": 10,
            "minimum": 1,
            "maximum": 100
          },
          "description": "Number of top players per job to compare"
        },
        {
          "name": "includeJobs",
          "in": "query",
          "schema": { "type": "string" },
          "description": "Comma-separated job types to include (e.g., '1,2,3')"
        }
      ],
      "responses": {
        "200": {
          "description": "Job leaderboard comparison retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean" },
                  "data": {
                    "type": "object",
                    "properties": {
                      "hunters": {
                        "type": "array",
                        "items": { "$ref": "#/components/schemas/JobRanking" }
                      },
                      "thieves": {
                        "type": "array",
                        "items": { "$ref": "#/components/schemas/JobRanking" }
                      },
                      "traders": {
                        "type": "array",
                        "items": { "$ref": "#/components/schemas/JobRanking" }
                      }
                    }
                  },
                  "summary": {
                    "type": "object",
                    "properties": {
                      "topPerformer": { "type": "string" },
                      "mostActiveJob": { "type": "string" },
                      "averageKD": { "type": "number" }
                    }
                  }
                }
              }
            }
          }
        },
        "500": { "$ref": "#/components/responses/InternalServerError" }
      }
    }
  },
  "/api/rankings/job-progression": {
    "get": {
      "tags": ["Rankings"],
      "summary": "Get job progression analytics",
      "description": "Advanced job progression analytics with trend analysis and performance metrics",
      "parameters": [
        {
          "name": "timeframe",
          "in": "query",
          "schema": {
            "type": "string",
            "enum": ["daily", "weekly", "monthly"],
            "default": "weekly"
          },
          "description": "Timeframe for progression analysis"
        },
        {
          "name": "jobType",
          "in": "query",
          "schema": { "type": "integer", "enum": [1, 2, 3] },
          "description": "Specific job type to analyze (1=Trader, 2=Thief, 3=Hunter)"
        }
      ],
      "responses": {
        "200": {
          "description": "Job progression analytics retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean" },
                  "data": {
                    "type": "object",
                    "properties": {
                      "trends": {
                        "type": "object",
                        "properties": {
                          "levelProgression": {
                            "type": "array",
                            "items": { "type": "number" }
                          },
                          "experienceGains": {
                            "type": "array",
                            "items": { "type": "number" }
                          },
                          "activityLevels": {
                            "type": "array",
                            "items": { "type": "number" }
                          }
                        }
                      },
                      "analytics": {
                        "type": "object",
                        "properties": {
                          "growthRate": { "type": "number" },
                          "retentionRate": { "type": "number" },
                          "averageSessionTime": { "type": "number" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "500": { "$ref": "#/components/responses/InternalServerError" }
      }
    }
  },
  "/api/rankings/cache/clear": {
    "get": {
      "tags": ["Rankings", "Cache"],
      "summary": "Clear ranking caches",
      "description": "Clear all ranking-related cache entries to force fresh database queries",
      "responses": {
        "200": {
          "description": "Cache cleared successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean", "example": true },
                  "message": {
                    "type": "string",
                    "example": "Ranking caches cleared successfully"
                  },
                  "clearedCount": { "type": "integer", "example": 15 },
                  "timestamp": { "type": "string", "format": "date-time" }
                }
              }
            }
          }
        },
        "500": { "$ref": "#/components/responses/InternalServerError" }
      }
    }
  },
  "/api/rankings/cache/clear-all": {
    "get": {
      "tags": ["Rankings", "Cache"],
      "summary": "Clear all caches (Nuclear Option)",
      "description": "⚠️ Clear ALL cache entries from the system. Use with caution!",
      "responses": {
        "200": {
          "description": "All caches cleared successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean", "example": true },
                  "message": {
                    "type": "string",
                    "example": "ALL caches cleared successfully (nuclear option)"
                  },
                  "clearedCount": { "type": "integer", "example": 50 },
                  "timestamp": { "type": "string", "format": "date-time" }
                }
              }
            }
          }
        },
        "500": { "$ref": "#/components/responses/InternalServerError" }
      }
    }
  },
  "/api/rankings/cache/stats": {
    "get": {
      "tags": ["Rankings", "Cache"],
      "summary": "Get cache statistics",
      "description": "Retrieve current cache statistics and information",
      "responses": {
        "200": {
          "description": "Cache statistics retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "success": { "type": "boolean", "example": true },
                  "data": {
                    "type": "object",
                    "properties": {
                      "enabled": { "type": "boolean", "example": true },
                      "type": { "type": "string", "example": "memory" },
                      "keyCount": { "type": "integer", "example": 25 },
                      "sampleKeys": {
                        "type": "array",
                        "items": { "type": "string" },
                        "example": [
                          "lafftale:player_ranking:123",
                          "lafftale:unique_ranking:456"
                        ]
                      }
                    }
                  },
                  "timestamp": { "type": "string", "format": "date-time" }
                }
              }
            }
          }
        },
        "500": { "$ref": "#/components/responses/InternalServerError" }
      }
    }
  }
}
